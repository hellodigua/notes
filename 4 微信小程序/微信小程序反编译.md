# 微信小程序反编译

由于微信开发者工具会对我们的代码进行编译、压缩混淆，所以真实的包是很难直接阅读的，这个时候想要看别人的代码就需要进行反编译。

反编译的目的是学习别人项目的代码思路，以便对项目进行更好的优化。

好下面进入正题，整个步骤分三步走：

1. 获取小程序的 .wxapkg 文件
2. 对.wxapkg 进行解包
3. 对解压缩后的包进行反编译

## 获取小程序的 .wxapkg 文件

工具：一台已越狱的 iPhone 或已 Root 的 Android 手机。

Android 手机上小程序包的存放目录为：

/data/data/com.tencent.mm/MicroMsg/{UserId}/appbrand/pkg/

iOS 手机上的小程序包的存放目录为：

/var/mobile/Containers/Data/Application/{Wechat Sandbox}/Library/WechatPrivate/{UserId}/WeApp/LocalCache/release/

我们可以通过文件创建的时间来推测这个包是属于哪个应用的。

## 对.wxapkg 进行解包

[解包工具和心得](https://github.com/leo9960/wechat-app-unpack)

解包后的文件解析：

- app-service.js: 小程序工程中所有 JS 文件的汇总，已被混淆；
- app-config.json: 小程序工程 app.json 以及各个页面的 JSON 配置文件汇总，可直接查看；
- page-frame.html: 所有页面的 .wxml 和 app.wxss 样式文件的汇总，可读性差，需要还原；
- \*.html: 包含每个页面对应的 .wxss 信息，可读性较好；
- 资源文件: 各类图片、音频等资源文件

## 反编译

使用[wxappUnpacker](https://github.com/qwerty472123/wxappUnpacker)进行反编译

反编译后，在微信开发者工具中新建一个空的小程序工程，然后导入相关目录，即可编译并运行。

## 参考链接

[微信小程序“反编译”实战（一）：解包](https://juejin.im/post/5af17b72518825383611ac38)

[微信小程序“反编译”实战（二）：源码还原](https://juejin.im/post/5af52cf46fb9a07aa34a4dcb)
