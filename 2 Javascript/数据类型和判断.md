## Javascript 的基本数据类型

### ECMAScript 标准

- 最新的 ECMAScript 标准定义了 7 种数据类型：

6 种原始类型：Boolean Null Undefined Number String Symbol 和 1 种特殊类型 Object

### 值类型和引用类型

值类型为 5 种基本类型：String Number Boolean Null Undefined
3 种引用类型：Object Array Function

他们的区别是：值类型的数据是存放在栈内存中的，而引用类型的数据是存放在堆内存中的

1、栈内存（stack）— 由编译器自动分配释放，存放函数的参数值，局部变量的值等。其操作方式类似于数据结构中的栈
2、堆内存（heap） — 一般由程序员分配释放，若程序员不释放，程序结束时可能由 OS 回收。它与数据结构中的堆是两回事，分配方式倒是类似于链表。

基本类型的复制，就是在栈内存中开辟出了一个新的存储区域用来存储新的变量；
引用类型的复制，实际上只是在栈内存中存储了一个指针，这个指针指向堆内存中该对象的存储地址。

### 特殊的 String 类型

string 类型有些特殊，因为字符串具有可变的大小，所以显然它不能被直接存储在具有固定大小的变量中。由于效率的原因，我们希望 JS 只复制对字符串的引用，而不是字符串的内容。

但是另一方面，字符串在许多方面都和基本类型的表现相似，而字符串是不可变的这一事实（即没法改变一个字符串值的内容），因此可以将字符串看成行为与基本类型相似的不可变引用类型。

### 基本包装类型

基本类型没有方法和属性，因为一旦创建了属性或者方法就会被立刻销毁，但是为了方便程序员对这类的基本类型数据比较方便的操作，所以在底层做了一些工作，对 Boolean、Number、String 进行了封装，也就是这三个其实是一个构造函数，他们是 Function 的实例。

### typeof 操作符

typeof 对以下 5 种数据类型返回下面的值（以字符串形式返回）

undefined ---------- 如果值未定义 Undefined
boolean ---------- 如果这个值是布尔值 Boolean
string ---------- 如果这个值是字符串 String
number ---------- 如果这个值是数值类型 Number
object ---------- 如果这个值是对象 Object
null ---------- 如果这个值是 null Object
function ---------- 如果这个值是函数 function

需要注意的是，typeof null 返回的是 Object, 因为 null 被认为是一个空的对象引用。

# 如何判断变量类型

## 储备知识

### typeof 操作符

- 对于基本类型，除 null 以外，均可以返回正确的结果。

  但是如果用 new 操作符来创建基本数据类型的实例时，typeof 判断为 object

- 对于引用类型，除 function 以外，一律返回 object 类型。

- 对于 null ，返回 object 类型。

### constructor 属性

- 除 null 和 undefined ，可以调用变量的 constructor 属性判断类型。

  但是，constructor 属性不稳定，有可能被开发者重写

### toString 方法

- 对变量调用该方法，默认返回其内部属性 [[Class]] ，格式为 [object Xxx] ，其中 Xxx 就是对象的类型。

## 代码参考

工具函数：

```javascript
function checkType(value) {
  return toString.call(value);
}

/**
 * Checks if `value` is object-like. A value is object-like if it's not `null`
 * and has a `typeof` result of "object".
 */
function isObjectLike(value) {
  return typeof value == 'object' && value !== null;
}
```

1. 判断 `Stirng`

```javascript
function isString(value) {
  const type = typeof value;
  return (
    type == 'string' ||
    (type == 'object' &&
      value != null &&
      !Array.isArray(value) &&
      checkType(value) == '[object String]')
  );
}
```

2. 判断 `Number`

```javascript
function isNumber(value) {
  return typeof value == 'number' || (isObjectLike(value) && checkType(value) == '[object Number]');
}
```

3. 判断 `Boolean`

```javascript
function isBoolean(value) {
  return (
    value === true ||
    value === false ||
    (isObjectLike(value) && checkType(value) == '[object Boolean]')
  );
}
```

4. 判断 `Null`

```javascript
function isNull(value) {
  return value === null;
}
```

5. 判断 `Undefined`

```javascript
function isUndefined(value) {
  return value === undefined;
}
```

6. 判断 `Object`

```javascript
function isObject(value) {
  const type = typeof value;
  return value != null && (type == 'object' || type == 'function');
}
```

7. 判断 `Function`

```javascript
function isFunction(value) {
  if (!isObject(value)) {
    return false;
  }

  const tag = checkType(value);
  return (
    tag == '[object Function]' ||
    tag == '[object AsyncFunction]' ||
    tag == '[object GeneratorFunction]' ||
    tag == '[object Proxy]'
  );
}
```

8. 判断 `Array`

```javascript
// ie9+
function isArray(value) {
  return Array.isArray(value);
}
```

9. 判断 `Date`

```javascript
function isDate(value) {
  return isObjectLike(value) && checkType(value) == '[object Date]';
}
```

10. 判断 `RegExp`

```javascript
function IsRegExp(value) {
  return isObjectLike(value) && checkType(value) == '[object RegExp]';
}
```

## 学习资料

[判断 JS 数据类型的四种方法](http://www.cnblogs.com/onepixel/p/5126046.html)

[lodash](https://github.com/lodash/lodash)

[toString 规范解析](https://segmentfault.com/a/1190000009407558)
